---
// 导入配置文件
import { siteConfig } from '../config/site.config.js';

// 从配置文件获取数据
const { UmamiConfig } = siteConfig;
---

{UmamiConfig.enable && (
  <script
    is:inline
    define:vars={{ src: UmamiConfig.src, websiteId: UmamiConfig.websiteId, domains: UmamiConfig.domains, autoTrack: UmamiConfig.autoTrack, delayLoad: UmamiConfig.delayLoad }}
  >
    // 延迟加载Umami脚本
    function loadUmami() {
      const script = document.createElement('script');
      script.defer = true;
      script.src = src;
      script.setAttribute('data-website-id', websiteId);

      if (domains) {
        script.setAttribute('data-domains', domains);
      }

      if (autoTrack !== undefined) {
        script.setAttribute('data-auto-track', autoTrack.toString());
      }

      document.head.appendChild(script);
    }

    // 延迟加载
    if (delayLoad && delayLoad > 0) {
      setTimeout(loadUmami, delayLoad);
    } else {
      loadUmami();
    }
  </script>
)}